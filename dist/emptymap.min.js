!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;"undefined"!=typeof window?i=window:"undefined"!=typeof global?i=global:"undefined"!=typeof self&&(i=self),i.EmptyMap=t()}}(function(){return function t(i,e,r){function o(n,a){if(!e[n]){if(!i[n]){var h="function"==typeof require&&require;if(!a&&h)return h(n,!0);if(s)return s(n,!0);var m=new Error("Cannot find module '"+n+"'");throw m.code="MODULE_NOT_FOUND",m}var p=e[n]={exports:{}};i[n][0].call(p.exports,function(t){var e=i[n][1][t];return o(e?e:t)},p,p.exports,t,i,e,r)}return e[n].exports}for(var s="function"==typeof require&&require,n=0;n<r.length;n++)o(r[n]);return o}({1:[function(t,i,e){var r=t("transformatrix"),o=function(t,i){t&&(this.vpSize=t,this.opt=i||{},this.projExt=this.opt.projExtent||{left:-20037508.342789244,right:20037508.342789244,bottom:-20037508.342789244,top:20037508.342789244},this.tSize=this.opt.tileSize||256,this.maxRes=Math.min(Math.abs(this.projExt.right-this.projExt.left)/this.tSize,Math.abs(this.projExt.top-this.projExt.bottom)/this.tSize),this.matrix=new r,this.tileMatrix=new r,this.opt.view&&this.opt.callback&&this.setVeiw(this.opt.view,this.opt.callback,this.opt.scope))};o.prototype.setView=function(t){var i=t.view,e=t.callback,r=t.scope||this;if("function"!=typeof e)throw new TypeError("callback is not function");return i?(i.center=i.center||[0,0],i.webScale=i.webScale?i.webScale:i.zoom?Math.pow(2,i.zoom):i.resolution?this.maxRes/i.resolution:0,i.rotation=i.rotation||0,this._setAt(i.center,i.webScale,i.rotation),void e.call(r,null,{matrix:this.matrix.m,tileMatrix:this.tileMatrix.m,map:this})):void e.call(r,new Error("view details are wrong"))},o.prototype.applyDeltaMove=function(t){var i=t.deltaX||0,e=t.deltaY||0,r=t.callback,o=t.scope||this;if("function"!=typeof r)throw new TypeError("callback is not function");var s=this.matrix.inverse().transformPoint(i,e),n=this.matrix.inverse().transformPoint(0,0);this.matrix.translate(s[0]-n[0],s[1]-n[1]),s=this.tileMatrix.inverse().transformPoint(i,e),n=this.tileMatrix.inverse().transformPoint(0,0),this.tileMatrix.translate(s[0]-n[0],s[1]-n[1]),r.call(o,null,{matrix:this.matrix.m,tileMatrix:this.tileMatrix.m,map:this})},o.prototype.applyDeltaScaleRotation=function(t){var i,e=t.position||[this.vpSize.width/2,this.vpSize.height/2],r=t.factor||1,o=t.rotation||0,s=t.callback,n=t.scope||this;if("function"!=typeof s)throw new TypeError("callback is not function");i=this.matrix.inverse().transformPoint(e[0],e[1]),this.matrix.translate(i[0],i[1]).rotate(Math.PI*o/180).scale(r,r).translate(-i[0],-i[1]),i=this.tileMatrix.inverse().transformPoint(e[0],e[1]),this.tileMatrix.translate(i[0],i[1]).rotate(Math.PI*o/180).scale(r,r).translate(-i[0],-i[1]),s.call(n,null,{matrix:this.matrix.m,tileMatrix:this.tileMatrix.m,map:this})},o.prototype.resetTileMatrix=function(t){var i=t.callback,e=t.scope||this;if("function"!=typeof i)throw new TypeError("callback is not function");var r=Math.atan2(this.tileMatrix.m[1],this.tileMatrix.m[0]);this.tileMatrix.reset(),this.tileMatrix.translate(this.vpSize.width/2,this.vpSize.height/2).rotate(r).translate(-this.vpSize.width/2,-this.vpSize.height/2),i.call(e,null,{matrix:this.matrix.m,tileMatrix:this.tileMatrix.m,map:this})},o.prototype.getCenter=function(){var t=this.matrix.inverse().transformPoint(this.vpSize.width/2,this.vpSize.height/2);return[this.projExt.left+t[0]*this.maxRes,this.projExt.top-t[1]*this.maxRes]},o.prototype.getZoom=function(){return Math.log(this._getWebScale())/Math.log(2)},o.prototype.getNearestZoom=function(){return Math.round(this.getZoom())},o.prototype._getWebScale=function(){var t=this.matrix.m;return Math.sqrt(t[0]*t[0]+t[1]*t[1])},o.prototype.getResolution=function(){return this.maxRes/this._getWebScale()},o.prototype.getRotation=function(){var t=this.matrix.m;return 180*Math.atan2(t[1],t[0])/Math.PI},o.prototype.getView=function(){return{center:this.getCenter(),zoom:this.getZoom(),resolution:this.maxRes/this._getWebScale(),rotation:this.getRotation()}},o.prototype.getExtent=function(){var t=this.matrix.inverse();return[this._basePxToLongLat(t.transformPoint(0,0)),this._basePxToLongLat(t.transformPoint(0,this.vpSize.height)),this._basePxToLongLat(t.transformPoint(this.vpSize.width,this.vpSize.height)),this._basePxToLongLat(t.transformPoint(this.vpSize.width,0))]},o.prototype.toLongLat=function(t){var i=this.matrix.inverse().transformPoint(t[0],t[1]);return this._basePxToLongLat(i)},o.prototype.toViewportPx=function(t){var i=this._longLatToBasePx(t);return this.matrix.transformPoint(i[0],i[1])},o.prototype.getViewportBBox=function(){var t,i,e,r,o,s,n;return t=this.getExtent(),i=t.map(function(t){return t[0]}),e=t.map(function(t){return t[1]}),r=Math.min.apply(this,i),o=Math.max.apply(this,i),n=Math.min.apply(this,e),s=Math.max.apply(this,e),{left:r,right:o,bottom:n,top:s}},o.prototype._setAt=function(t,i,e){var r=this._longLatToBasePx(t);this.matrix.reset(),this.matrix.translate(r[0],r[1]).rotate(Math.PI/180*e).scale(i,i).translate(-r[0],-r[1]);var o=this.matrix.inverse().transformPoint(this.vpSize.width/2,this.vpSize.height/2);this.matrix.translate(o[0]-r[0],o[1]-r[1]),this.tileMatrix.reset(),this.tileMatrix.translate(this.vpSize.width/2,this.vpSize.height/2).rotate(e*Math.PI/180).translate(-this.vpSize.width/2,-this.vpSize.height/2)},o.prototype._longLatToBasePx=function(t){return[(t[0]-this.projExt.left)/this.maxRes,(this.projExt.top-t[1])/this.maxRes]},o.prototype._basePxToLongLat=function(t){return[this.projExt.left+t[0]*this.maxRes,this.projExt.top-t[1]*this.maxRes]},i.exports=o},{transformatrix:2}],2:[function(t,i,e){var r=function(){this.reset()};r.prototype.reset=function(){return this.m=[1,0,0,1,0,0],this},r.prototype.multiply=function(t){var i=this.m[0]*t.m[0]+this.m[2]*t.m[1],e=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],o=this.m[1]*t.m[2]+this.m[3]*t.m[3],s=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],n=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=i,this.m[1]=e,this.m[2]=r,this.m[3]=o,this.m[4]=s,this.m[5]=n,this},r.prototype.inverse=function(){var t=new r;t.m=this.m.slice(0);var i=1/(t.m[0]*t.m[3]-t.m[1]*t.m[2]),e=t.m[3]*i,o=-t.m[1]*i,s=-t.m[2]*i,n=t.m[0]*i,a=i*(t.m[2]*t.m[5]-t.m[3]*t.m[4]),h=i*(t.m[1]*t.m[4]-t.m[0]*t.m[5]);return t.m[0]=e,t.m[1]=o,t.m[2]=s,t.m[3]=n,t.m[4]=a,t.m[5]=h,t},r.prototype.rotate=function(t){var i=Math.cos(t),e=Math.sin(t),r=this.m[0]*i+this.m[2]*e,o=this.m[1]*i+this.m[3]*e,s=this.m[0]*-e+this.m[2]*i,n=this.m[1]*-e+this.m[3]*i;return this.m[0]=r,this.m[1]=o,this.m[2]=s,this.m[3]=n,this},r.prototype.translate=function(t,i){return this.m[4]+=this.m[0]*t+this.m[2]*i,this.m[5]+=this.m[1]*t+this.m[3]*i,this},r.prototype.scale=function(t,i){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=i,this.m[3]*=i,this},r.prototype.transformPoint=function(t,i){var e=t,r=i;return t=e*this.m[0]+r*this.m[2]+this.m[4],i=e*this.m[1]+r*this.m[3]+this.m[5],[t,i]},r.prototype.transformVector=function(t,i){var e=t,r=i;return t=e*this.m[0]+r*this.m[2],i=e*this.m[1]+r*this.m[3],[t,i]},"undefined"!=typeof i?i.exports=r:window.Matrix=r},{}]},{},[1])(1)});